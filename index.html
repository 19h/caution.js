<script src="modules/caution.js"></script>
<script>
caution.undefine(); // removes from module list
var baseUrl = location.href.replace(/[^\/]+$/, '');
caution.urls = function (moduleName) {
	return [
		moduleName + '.js',
		'modules/' + moduleName + '.js'
	];
};
caution.load('caution', ['']);
caution.load('main-page', ['']);
define(['caution', 'main-page'], function (caution) {
	var config = {
		paths: [{'main-page': baseUrl + 'main-page.js'}, baseUrl + 'modules/{}.js'],
		load: {
			'caution': [caution.moduleHash('caution')],
			'main-page': [caution.moduleHash('main-page')]
		}
	};
	
	var url = caution.dataUrl(config, {baseUrl: baseUrl});
	if (!/noredirect/.test(location.href)) return location.replace(url);

	var js = caution.inlineJs(config, {baseUrl: baseUrl});
	console.log(js);
	console.log(url);
	console.log('length', url.length);
});
</script>